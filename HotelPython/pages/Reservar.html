<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reservas</title>
    <link rel="shortcut icon" href="../img/logo4.png" type="image/x-icon">
    <link rel="stylesheet" href="./css/estilos_menu.css">
    <link rel="stylesheet" href="../css/estilos_reservas.css">
    <script src="script.js"></script>
    <!-- Otras etiquetas head -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="./menu.js"></script>
</head>

<body>
    <main class="contenedor-principal">

        <section class="menu">
            <div>
                <img src="../img/logo3.png" alt="Logo Hotel Python">
            </div>

            <button id="menu">
                <span id="menu-abrir">&#9776;</span>
                <span id="menu-cerrar">X</span>
            </button>

            <nav>
                <ul>
                    <li><a href="../index.html">INICIO</a></li>
                    <li><a href="./Habitacion.html">HABITACIONES</a></li>
                    <li><a href="./Servicios.html">SERVICIOS</a></li>
                    <li><a href="./comentarios.html">COMENTARIOS</a></li>
                    <li><a href="../index.html#contactanos">CONTACTO</a></li>
                </ul>
            </nav>
            <div class="reservar">
                <a id="reservar-link" href="./pages/Reservar.html">RESERVAR</a>
                <img src="../img/notificacion.png" alt="Campana">
                <audio id="campana-audio" src="../sound/call-to-attention-123107.mp3"></audio>
                <script>
                    const campana = document.querySelector(".reservar img");
                    const reservarLink = document.getElementById("reservar-link");
                    const campanaAudio = document.getElementById("campana-audio");
            
                    campana.addEventListener("click", () => {
                        campanaAudio.play();
                    });
            
                    reservarLink.addEventListener("click", (e) => {
                        e.preventDefault(); // Evita la navegación predeterminada
                        campanaAudio.play();
                        setTimeout(() => {
                            // Redirige a la página "Reservar.html" después de que termine el sonido
                            window.location.href = reservarLink.href;
                        }, campanaAudio.duration * 1000); // Espera la duración del sonido en milisegundos antes de redirigir
                    });
                </script>
            </div>
        </section>

        <section class="inicio" id="inicio">
            <h1 align="center">RESERVAS</h1>
            <p> Elegí la habitación a tu medida <br>¡Reservá sin costo por cancelación!</p>
        </section>


        <section class="contacto">
            <h1>Complete el siguiente <br> formulario</h1>
            <h3>Datos de la reserva</h3>
            <p>Durante todo el mes de diciembre, su reserva no abona impuestos por cancelación 😊</p>
            <a href="#inicio">Volver</a>
        </section>

        <section class="formContacto">
            <form id="formulario" action="http://127.0.0.1:5000/reservas" method="POST">

                <label for="lastname">Apellido huesped principal: </label>
                <input size="30" type="text" name="lastname" id="lastname" placeholder="Ingrese su nombre aqui">

                <br><br>
                <label for="firstname">Nombre huesped principal:</label>
                <input size="30" type="text" name="firstname" id="firstname" placeholder="Ingrese su apellido aqui...">

                <br><br>
                <label for="dni">DNI:</label>
                <input type="number" name="number" id="dni" placeholder="Ingrese el numero de huéspedes..">

                <br><br>
                <label for="mail">Mail: </label>
                <input type="email" name="mail" id="mail" placeholder="Ingrese su email" required>

                <br><br>
                <label for="number">Cantidad de huéspedes:</label>
                <input type="number" name="number" id="number" placeholder="Ingrese el numero de huéspedes.." required min="1" max="20">

                <br><br>
                <label for="habitacion">Seleccione una habitación:</label>
                <select name="habitacion" id="habitacion">
                    <option value="html">Habitación HTML</option>
                    <option value="css">Habitación CSS</option>
                    <option value="javascript">Habitación JavaScript</option>
                    <option value="python">Habitación Python</option>
                </select>

                <div>
                    <!-- Contenido del cuerpo del HTML -->
                    <br><br>
                    <label for="fecha_de_ingreso">Fecha de ingreso:</label>
                    <input type="text" id="fecha_de_ingreso" name="fecha_de_ingreso">

                    <br><br>

                    <label for="fecha_de_salida">Fecha de salida:</label>
                    <input type="text" id="fecha_de_salida" name="fecha_de_salida">
                    <br><br>

                    <!-- Script para inicializar flatpickr -->
                    <script>
                        flatpickr("#fecha_de_ingreso");
                        flatpickr("#fecha_de_salida");
                    </script>
                </div>

                <br>
                <input type="submit" value="Enviar" href="http://127.0.0.1:5000/reservas">
                <button type="reset">Reset</button>
            </form>
        </section>


        <section class="ubiContacto">
            <iframe
                src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d12510.750058863136!2d-86.81204898788846!3d21.213272899505586!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1ses-419!2sar!4v1694613131708!5m2!1ses-419!2sar"
                width="500" height="400" style="border:0;" allowfullscreen="" loading="lazy"
                referrerpolicy="no-referrer-when-downgrade"></iframe>
        </section>


        <footer class="footer">
            <div>
                <p>Crta puerto Juares a Punta Sam km 3,5.
                    <br>Carr. a Punta Sam 3,5.
                    <br>77999 Cancun, Q.R., Mexico
                </p>
            </div>
            <div>
                <img src="../img/logo4.png" alt="Logo Hotel Python">
            </div>
            <div>
                <ul>
                    <li><a href="https://wa.me/542235537891?text=%C2%A1Hola!%20%C2%A1Quiero%20reservar%20lugar!%20%F0%9F%8F%96%EF%B8%8F">📞 Teléfono: 223 5567892 </a></li>
            <li><a href="mailto:hotelpython@gmail.com">📧 hotelpython@gmail.com</a></li>

                </ul>
            </div>
        </footer>

        <div class="administrador">
            <a href="./administrador.html">Ingresar como Administrador</a>
        </div>

        <script>
            const URL = "http://127.0.0.1:5000/"
    
            // Capturamos el evento de envío del formulario
            document.getElementById('formulario').addEventListener('submit', function (event) {
                event.preventDefault(); // Evitamos que se envie el form 
    
                var formData = new FormData();
                formData.append('firstname', document.getElementById('firstname').value);
                formData.append('lastname', document.getElementById('lastname').value);
                formData.append('dni', document.getElementById('dni').value);
                formData.append('mail', document.getElementById('mail').value);
                formData.append('number', document.getElementById('number').value);
                formData.append('habitacion', document.getElementById('habitacion').value);
                formData.append('fecha_de_ingreso', document.getElementById('fecha_de_ingreso').value);
                formData.append('fecha_de_egreso', document.getElementById('fecha_de_salida').value);

                
                fetch(URL + 'reservas', {
                    method: 'POST',
                    body: formData // Aquí enviamos formData en lugar de JSON
                })
                .then(function (response) {
                    if (response.ok) { return response.json(); }
                })
                .then(function (data) {
                    alert('Reserva registrada correctamente.');
                    // Limpiar el formulario para el proximo producto
                    document.getElementById('lastname').value= "";
                    document.getElementById('firstname').value= "";
                    document.getElementById('dni').value= "";
                    document.getElementById('mail').value= "";
                    document.getElementById('number').value= "";
                    document.getElementById('habitacion').value= "";
                    document.getElementById('fecha_de_ingreso').value= "";
                    document.getElementById('fecha_de_salida').value= "";
                })
                .catch(function (error) {
                    // Mostramos el error, y no limpiamos el form.
                    alert('Error al agregar la reserva.');
                });
            })
        </script>


</body>

</html>